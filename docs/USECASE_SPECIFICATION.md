# 유스케이스 명세서

## UC-01: 회원가입

**유스케이스 이름**: 회원가입  
**유스케이스 ID**: UC-01  
**관련 요구사항**: FR-AD-001, FR-AD-002, FR-AD-003  
**우선순위**: 상  
**선행조건**: 없음  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 회원가입 페이지에 접근
2. 아이디, 비밀번호, 이메일 입력
3. 아이디 중복 검사 요청 (POST /auth/check-duplicate)
4. 이메일 인증번호 발송 요청 (POST /auth/send-verification)
5. 이메일 인증번호 입력 및 확인 (POST /auth/verify-code)
6. 회원가입 요청 (POST /auth/join)
7. 시스템이 사용자 정보를 DB에 저장
8. 회원가입 완료 메시지 표시

**종료조건**: 
- 성공: 사용자 계정이 생성되고 로그인 페이지로 이동
- 실패: 오류 메시지 표시 및 회원가입 페이지 유지

---

## UC-02: 로그인

**유스케이스 이름**: 로그인  
**유스케이스 ID**: UC-02  
**관련 요구사항**: FR-AD-004, FR-AD-005  
**우선순위**: 상  
**선행조건**: 회원가입 완료  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 로그인 페이지에 접근
2. 아이디와 비밀번호 입력
3. 로그인 요청 (POST /auth/login)
4. 시스템이 아이디와 비밀번호 검증
5. 검증 성공 시 JWT 토큰 발급
6. 토큰을 세션 스토리지에 저장
7. 워크플레이스 페이지로 이동

**종료조건**: 
- 성공: JWT 토큰 발급 및 워크플레이스 페이지 이동
- 실패: 오류 메시지 표시 및 로그인 페이지 유지

---

## UC-03: 리뷰 데이터 수집

**유스케이스 이름**: 리뷰 데이터 수집  
**유스케이스 ID**: UC-03  
**관련 요구사항**: FR-RV-001(파일 업로드), FR-RV-002(컬럼 매핑), FR-RV-003(데이터 파싱/검증), FR-RV-004(리뷰 저장), FR-RV-005(중복 리뷰 체크)  
**우선순위**: 상  
**선행조건**: 사용자 로그인, 제품 생성 완료  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스에서 제품 선택
2. "Add Review" 버튼 클릭
3. 리뷰 파일 업로드 모달 열기
4. CSV 또는 Excel 파일 선택 (드래그 앤 드롭 또는 브라우저)
5. 파일 미리보기 및 컬럼 매핑
   - 리뷰 컬럼 선택 (필수)
   - 날짜 컬럼 선택 (필수)
   - 평점 컬럼 선택 (선택, 스팀 리뷰의 경우 voted_up 선택)
6. "Analyze" 버튼 클릭
7. 파일 업로드 요청 (POST /products/{id}/reviews/upload)
8. 시스템이 파일 파싱 (CSV/Excel)
9. 시스템이 파일 내용 검증 (매직 넘버 확인)
10. 각 행의 데이터 검증 (리뷰 텍스트, 날짜, 평점)
11. 중복 리뷰 체크 (product_id, review_text, review_date 조합)
12. 중복이 아닌 리뷰만 DB에 삽입
13. 리뷰 삽입 완료 후 자동으로 리뷰 분석 실행
14. 업로드 결과 반환 (삽입/건너뛰기/중복 개수)

**종료조건**: 
- 성공: 리뷰가 DB에 저장되고 분석이 완료됨
- 실패: 오류 메시지 표시 및 업로드 실패

---

## UC-04: 제품 생성

**유스케이스 이름**: 제품 생성  
**유스케이스 ID**: UC-04  
**관련 요구사항**: FR-AD-010, FR-AD-011  
**우선순위**: 상  
**선행조건**: 사용자 로그인  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스에서 "Add" 버튼 클릭
2. 제품 정보 입력 모달 열기
3. 제품명, 브랜드, 카테고리 입력
4. "Next" 버튼 클릭
5. 파일 업로드 모달로 이동 (선택사항)
6. 제품 생성 요청 (POST /products)
7. 시스템이 제품 정보를 DB에 저장 (user_id 포함)
8. 제품 생성 완료 메시지 표시
9. 워크플레이스 목록 새로고침

**종료조건**: 
- 성공: 제품이 DB에 저장되고 워크플레이스 목록에 표시됨
- 실패: 오류 메시지 표시 및 제품 정보 입력 페이지 유지

---

## UC-05: 제품 목록 조회

**유스케이스 이름**: 제품 목록 조회  
**유스케이스 ID**: UC-05  
**관련 요구사항**: FR-AD-012, FR-AD-013  
**우선순위**: 상  
**선행조건**: 사용자 로그인  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스 페이지에 접근
2. 제품 목록 조회 요청 (GET /products)
3. 시스템이 해당 사용자의 제품만 조회 (WHERE user_id = ?)
4. 제품 목록 반환 (제품명, 브랜드, 카테고리, 등록일)
5. 목록 화면에 표시
6. 검색, 필터링, 정렬 기능 제공

**종료조건**: 
- 성공: 사용자의 제품 목록이 화면에 표시됨
- 실패: 오류 메시지 표시

---

## UC-06: 제품 정보 수정

**유스케이스 이름**: 제품 정보 수정  
**유스케이스 ID**: UC-06  
**관련 요구사항**: FR-AD-014  
**우선순위**: 중  
**선행조건**: 사용자 로그인, 제품 존재  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스에서 제품 선택
2. 메뉴 버튼 클릭 → "Edit" 선택
3. 제품 정보 수정 모달 열기 (기존 정보 표시)
4. 제품명, 브랜드, 카테고리 수정
5. "Save" 버튼 클릭
6. 제품 수정 요청 (PUT /products/{id})
7. 시스템이 제품 소유권 확인
8. 시스템이 제품 정보 업데이트
9. 수정 완료 메시지 표시
10. 워크플레이스 목록 새로고침

**종료조건**: 
- 성공: 제품 정보가 업데이트되고 목록에 반영됨
- 실패: 오류 메시지 표시 및 수정 페이지 유지

---

## UC-07: 제품 삭제

**유스케이스 이름**: 제품 삭제  
**유스케이스 ID**: UC-07  
**관련 요구사항**: FR-AD-015  
**우선순위**: 중  
**선행조건**: 사용자 로그인, 제품 존재  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스에서 제품 선택
2. 메뉴 버튼 클릭 → "Delete" 선택
3. 삭제 확인 다이얼로그 표시
4. 사용자가 확인 클릭
5. 제품 삭제 요청 (DELETE /products/{id})
6. 시스템이 제품 소유권 확인
7. 시스템이 제품 및 관련 데이터 삭제 (CASCADE)
8. 삭제 완료 메시지 표시
9. 워크플레이스 목록 새로고침

**종료조건**: 
- 성공: 제품이 삭제되고 목록에서 제거됨
- 실패: 오류 메시지 표시 및 목록 유지

---

## UC-08: 리뷰 분석 요청

**유스케이스 이름**: 리뷰 분석 요청  
**유스케이스 ID**: UC-08  
**관련 요구사항**: FR-AN-001, FR-AN-002, FR-AN-003, FR-AN-004  
**우선순위**: 상  
**선행조건**: 사용자 로그인, 제품 존재, 리뷰 데이터 존재  
**관련 액터**: 사용자(User), AI 분석 서버

**이벤트 흐름**:
1. 리뷰 업로드 완료 시 자동 실행 또는 사용자가 수동 요청
2. 리뷰 분석 요청 (내부 함수 호출: performAnalysis)
3. Python AI 서버에 분석 요청 (POST /v1/products/{product_id}/reviews/analysis)
4. AI 서버가 리뷰 데이터 조회
5. AI 서버가 감정 분석 수행 (ABSA)
6. AI 서버가 분석 결과를 tb_reviewAnalysis에 저장
7. AI 서버가 인사이트 생성 (LangChain + OpenAI)
8. AI 서버가 인사이트를 tb_productInsight에 저장
9. AI 서버가 대시보드 데이터 업데이트 (프로시저 호출)
10. AI 서버가 워드클라우드 생성
11. 분석 완료 응답 반환

**종료조건**: 
- 성공: 리뷰 분석이 완료되고 대시보드 데이터가 업데이트됨
- 실패: 오류 메시지 표시 및 분석 실패

---

## UC-09: 대시보드 조회

**유스케이스 이름**: 대시보드 조회  
**유스케이스 ID**: UC-09  
**관련 요구사항**: FR-UI-001, FR-UI-002, FR-UI-003, FR-UI-005, FR-UI-006  
**우선순위**: 상  
**선행조건**: 사용자 로그인, 제품 존재, 리뷰 분석 완료  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 워크플레이스에서 제품 클릭 또는 대시보드 페이지 직접 접근
2. 대시보드 데이터 조회 요청 (GET /products/{id}/dashboard)
3. 시스템이 대시보드 데이터 조회 (tb_productDashboard)
4. 시스템이 관련 데이터 조회 (키워드, 인사이트, 워드클라우드)
5. 데이터 처리 및 변환
6. 대시보드 화면에 표시:
   - KPI 카드 (전체 리뷰 수, 긍정/부정 비율, 제품 점수)
   - 차트 (일별 트렌드, 레이더 차트, 분할 막대 차트, 히트맵)
   - 워드클라우드
   - 리뷰 샘플
   - 키워드 인사이트
   - AI 인사이트 리포트
7. 날짜 필터링 기능 제공
8. PDF 다운로드 기능 제공

**종료조건**: 
- 성공: 대시보드 데이터가 화면에 표시됨
- 실패: 오류 메시지 표시 (404인 경우 워크플레이스로 이동 제안)

---

## UC-10: 리뷰 조회

**유스케이스 이름**: 리뷰 조회  
**유스케이스 ID**: UC-10  
**관련 요구사항**: FR-RV-006  
**우선순위**: 중  
**선행조건**: 사용자 로그인, 제품 존재  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 대시보드에서 리뷰 조회 요청
2. 리뷰 조회 요청 (GET /products/{id}/reviews?keyword={keyword})
3. 시스템이 리뷰 데이터 조회 (키워드 필터링 옵션)
4. 리뷰 목록 반환
5. 화면에 리뷰 표시 (날짜, 내용, 감정 요약)

**종료조건**: 
- 성공: 리뷰 목록이 화면에 표시됨
- 실패: 오류 메시지 표시

---

## UC-11: 아이디 찾기

**유스케이스 이름**: 아이디 찾기  
**유스케이스 ID**: UC-11  
**관련 요구사항**: FR-AD-006  
**우선순위**: 중  
**선행조건**: 없음  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 로그인 페이지에서 "아이디 찾기" 클릭
2. 이메일 입력
3. 아이디 찾기 요청 (POST /auth/find-id)
4. 시스템이 이메일로 등록된 아이디 조회
5. 아이디 반환 (일부 마스킹 처리)

**종료조건**: 
- 성공: 아이디가 화면에 표시됨
- 실패: 오류 메시지 표시

---

## UC-12: 비밀번호 찾기

**유스케이스 이름**: 비밀번호 찾기  
**유스케이스 ID**: UC-12  
**관련 요구사항**: FR-AD-007  
**우선순위**: 중  
**선행조건**: 없음  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 로그인 페이지에서 "비밀번호 찾기" 클릭
2. 아이디와 이메일 입력
3. 비밀번호 찾기 요청 (POST /auth/find-password)
4. 시스템이 아이디와 이메일 일치 확인
5. 임시 비밀번호 생성 및 이메일 발송
6. 비밀번호 업데이트

**종료조건**: 
- 성공: 임시 비밀번호가 이메일로 발송됨
- 실패: 오류 메시지 표시

---

## UC-13: 회원정보 수정

**유스케이스 이름**: 회원정보 수정  
**유스케이스 ID**: UC-13  
**관련 요구사항**: FR-AD-008  
**우선순위**: 중  
**선행조건**: 사용자 로그인  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 회원정보 수정 페이지에 접근
2. 현재 정보 표시
3. 수정할 정보 입력 (비밀번호, 이메일 등)
4. 회원정보 수정 요청 (POST /auth/update-profile)
5. 시스템이 사용자 인증 확인
6. 시스템이 회원정보 업데이트
7. 수정 완료 메시지 표시

**종료조건**: 
- 성공: 회원정보가 업데이트됨
- 실패: 오류 메시지 표시

---

## UC-14: 회원탈퇴

**유스케이스 이름**: 회원탈퇴  
**유스케이스 ID**: UC-14  
**관련 요구사항**: FR-AD-009  
**우선순위**: 하  
**선행조건**: 사용자 로그인  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 회원탈퇴 페이지에 접근
2. 탈퇴 확인 다이얼로그 표시
3. 사용자가 확인 클릭
4. 회원탈퇴 요청 (DELETE /auth/withdraw)
5. 시스템이 사용자 인증 확인
6. 시스템이 사용자 계정 삭제 (tb_user 테이블에서 삭제)
7. 탈퇴 완료 메시지 표시
8. 로그아웃 및 메인 페이지로 이동

**종료조건**: 
- 성공: 사용자 계정이 삭제되고 메인 페이지로 이동
- 실패: 오류 메시지 표시

---

## UC-15: 대시보드 PDF 다운로드

**유스케이스 이름**: 대시보드 PDF 다운로드  
**유스케이스 ID**: UC-15  
**관련 요구사항**: FR-UI-004  
**우선순위**: 중  
**선행조건**: 사용자 로그인, 대시보드 조회 완료  
**관련 액터**: 사용자(User)

**이벤트 흐름**:
1. 사용자가 대시보드 페이지에서 "PDF 다운로드" 버튼 클릭
2. 대시보드 콘텐츠를 PDF로 변환
3. PDF 파일 생성
4. 파일 다운로드

**종료조건**: 
- 성공: PDF 파일이 다운로드됨
- 실패: 오류 메시지 표시

